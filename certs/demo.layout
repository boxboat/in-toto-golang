{
  "_type": "layout",
  "expires": "2030-11-18T16:06:36Z",
  "inspect": [
   {
    "_type": "inspection",
    "expected_materials": [
     [
      "MATCH",
      "foo.tar.gz",
      "WITH",
      "PRODUCTS",
      "FROM",
      "package"
     ],
     [
      "DISALLOW",
      "foo.tar.gz"
     ]
    ],
    "expected_products": [
     [
      "MATCH",
      "foo.py",
      "WITH",
      "PRODUCTS",
      "FROM",
      "write-code"
     ],
     [
      "DISALLOW",
      "foo.py"
     ]
    ],
    "name": "untar",
    "run": [
     "tar",
     "xfz",
     "foo.tar.gz"
    ]
   }
  ],
  "intermediatecas": [],
  "keys": {},
  "readme": "",
  "rootcas": [
   "-----BEGIN CERTIFICATE-----\nMIIDqjCCApKgAwIBAgIUFui65YGh9VnGaU5R8gukgO3L2kIwDQYJKoZIhvcNAQEN\nBQAwKzEQMA4GA1UECgwHZXhhbXBsZTEXMBUGA1UECwwOZXhhbXBsZUNOPXJvb3Qw\nHhcNMjEwMjE5MjE0OTA3WhcNMzEwMjE3MjE0OTA3WjArMRAwDgYDVQQKDAdleGFt\ncGxlMRcwFQYDVQQLDA5leGFtcGxlQ049cm9vdDCCASIwDQYJKoZIhvcNAQEBBQAD\nggEPADCCAQoCggEBAMBYCP7qJPEXlg2fIJRuHT4mTBsa+GD4Iu7PaRv8QTRBBI7D\nI9NWT3sJ9kHfglCM/S6OAc/9txKIvFdK4Wxajn+Z4sVfU6kLnR8y1+f8GsuQzioA\n8e9r/0jEGoTXnEl94ZqGUoM1zYqKX/k8vKj9LnG7aVFtY5WMTw+S8wL2AkJOMOC2\nPEMYx/tnUvQ7UyFe24Ysi8IOH2UWKqsHOgYMaqhe0Z9Bk1QMUn3xqbsoCtR4tkmc\nd861K0vidqFP+rg0eUBEOGMtQwjZzpoFcycvPvaHVYxWV2osQ71PnZuEfDF7YGQ+\nS+t2WS4DQMWjBKuUVEO8heeEvh36IyL+br4jXYsCAwEAAaOBxTCBwjAdBgNVHQ4E\nFgQUVsmfEccMtsadxpr0CiLmunRbkwUwZgYDVR0jBF8wXYAUVsmfEccMtsadxpr0\nCiLmunRbkwWhL6QtMCsxEDAOBgNVBAoMB2V4YW1wbGUxFzAVBgNVBAsMDmV4YW1w\nbGVDTj1yb290ghQW6LrlgaH1WcZpTlHyC6SA7cvaQjAPBgNVHRMBAf8EBTADAQH/\nMA4GA1UdDwEB/wQEAwIBBjAYBgNVHREEETAPhg1zcGlmZmU6Ly9yb290MA0GCSqG\nSIb3DQEBDQUAA4IBAQC2Aar29S2z/vq/rGaeoAcxK8UYHfWmKgjxD4o9VShFf/gR\n7wCFTG2sC409Zz0Jy6cI1DcbYl0qeBESNgU08QiZeju1mnNY5ImLo+h7CA/IHPJn\nDA6mVwHx5fC9oS1MlCoyLP5xbZqcqt2GOylJbxevTp3OyKK9MSRW/ws6p/HEDFh9\nyMq+K+hFTP6oVwngRVMj7R/rKRp/Xe7uveLnAbZ8cIcOPbXgtyiO0ffLVKhvrBCh\nsjWQwwCeIWFfE8rIl2mWntjRKETbICQ5NOzaUk8H6iA3nFPLEyMv+CsP8nYeBQn3\nWCWIFiWW869MfU5z3GDGilGzpiDglpwqcnPFMM9c\n-----END CERTIFICATE-----\n"
  ],
  "steps": [
   {
    "_type": "step",
    "cert_constraints": [
     {
      "common_name": "write-code.example.com",
      "uris": [
       "spiffe://example.com/write-code"
      ]
     }
    ],
    "expected_command": [],
    "expected_materials": [],
    "expected_products": [
     [
      "ALLOW",
      "foo.py"
     ]
    ],
    "name": "write-code",
    "pubkeys": [],
    "threshold": 1
   },
   {
    "_type": "step",
    "cert_constraints": [
     {
      "common_name": "package.example.com",
      "uris": [
       "spiffe://example.com/package"
      ]
     }
    ],
    "expected_command": [
     "tar",
     "zcvf",
     "foo.tar.gz",
     "foo.py"
    ],
    "expected_materials": [
     [
      "MATCH",
      "foo.py",
      "WITH",
      "PRODUCTS",
      "FROM",
      "write-code"
     ],
     [
      "DISALLOW",
      "*"
     ]
    ],
    "expected_products": [
     [
      "ALLOW",
      "foo.tar.gz"
     ],
     [
      "ALLOW",
      "foo.py"
     ]
    ],
    "name": "package",
    "pubkeys": [],
    "threshold": 1
   }
  ]
}
